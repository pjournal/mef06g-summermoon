geom_text(aes(label = scales::percent(round(pop_not_in_lab_force_rate,2))),
position = position_stack(vjust = 0.5), size = 2, angle = -80) +
facet_wrap( ~ gender) +
xlab("") +
ylab("") +
theme_void() +
theme(legend.text=element_text(size=4), legend.position = "bottom", legend.title=element_blank())
plot_data1<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(desc(avg_rate)) %>%
top_n(5)
ggplot(plot_data1,aes(x=reorder(province, -avg_rate), y=avg_rate, fill= province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the average divorce rate") +
xlab("province") +
ylab("average divorce rate")
plot_data2<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(avg_rate) %>%
slice(1:5)
ggplot(plot_data2,aes(x=reorder(province, -avg_rate), y=avg_rate, fill=province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the lowest average divorce rate") +
xlab("province") +
ylab("average divorce rate")
labour_force_status_by_reg <- readRDS("docs/tuik/Labour_force_status_by_reg.rds")
employed_rate_by_marital_status <- readRDS("docs/tuik/Employed_rate_by_marital_status.rds")
female<-employed_rate_by_marital_status%>%filter(gender=="Female")
male<-employed_rate_by_marital_status%>%filter(gender=="Male")
reasons_of_not_being_in_lab_for <- readRDS("docs/tuik/Reasons_of_not_being_in_lab_for.rds")
crude_divorce_rate_by_provinces <- readRDS("docs/tuik/Crude_divorce_rate_by_provinces.rds")
mean_age_of_mother_by_statistic <- readRDS("docs/tuik/Mean_age_of_mother_by_Statistic.rds")
labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, employment_rate, unemployment_rate) %>%
pivot_longer(cols = -c(gender, year), values_to = "value", names_to = "variable") %>%
ggplot(aes(x = year, y = value, fill = reorder(variable, value))) +
geom_bar(position="dodge", stat="identity") +
facet_grid(. ~ gender) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1), legend.position="top", legend.title=element_blank()) +
coord_flip() +
labs(title = "Labour Force Rates by Gender")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot() +
geom_line(aes(x = year, y = labour_force_participation_rate, color = gender)) +
facet_wrap( ~ region) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Labour Force Participation Rate by Region")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot() +
geom_line(aes(x = year, y = employment_rate, color = gender)) +
facet_wrap( ~ region) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Employment Rate by Region")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot() +
geom_line(aes(x = year, y = unemployment_rate, color = gender)) +
facet_wrap( ~ region) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Unemployment Rate by Region")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot(aes(y=unemployment_rate, group = gender)) +
geom_boxplot(fill="steelblue") +
facet_grid(gender ~ region) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
theme(strip.text.x = element_text(size = 5)) +
labs(title = "Unemployment Distribution by Region")
reasons_of_not_being_in_lab_for %>%
#filter(gender == "Female") %>%
group_by(reason,year, gender) %>%
summarise(sum_of_not_in_lab_force = sum(pop_not_in_lab_force)) %>%
pivot_wider(values_from = sum_of_not_in_lab_force, names_from = gender) %>%
transmute(year = year,reason = reason, Female_ = Female/ (Female+Male), Male_ = 1 - Female/ (Female+Male)) %>%
pivot_longer(cols= ends_with("ale_"),values_to = "ratio_not_in_labor_force", names_to = "gender") %>%
ggplot(aes(x = year, y = ratio_not_in_labor_force, color = gender)) +
geom_line() +
facet_wrap( ~ reason) +
labs(title = "Reasons of not being in labour force by Gender")
diff<-female%>%mutate(ratio=male$employed_rate/female$employed_rate) %>%select(-gender)
ggplot(diff, aes(x = year, y = ratio, color = marital_status)) + geom_line() +
scale_x_continuous(breaks = c(min(female$year):max(female$year))) +
labs(title = "Employment Ratio")
mean_age_of_mother_by_statistic %>%
filter(province == "İstanbul") %>%
ggplot(aes(x = year, y = mother_mean_age)) +
geom_line() +
coord_cartesian(xlim = c(2009,2021),ylim = c(25,max(mean_age_of_mother_by_statistic$mother_mean_age + 5))) +
geom_line(arrow = arrow(), aes(color = year)) +
geom_point(color = "#0099f9", size = 5) +
labs(title = "Mean Age of Mother by Year in İstanbul")
five_metropolis <- c("İstanbul","Ankara","İzmir","Bursa","Adana")
mean_age_of_mother_by_statistic %>%
filter(province %in% five_metropolis, year %in% c(2019,2020,2021)) %>%
ggplot(aes(x = year, y= mother_mean_age)) +
geom_bar(stat = "identity", position = position_dodge(), alpha = 0.75) +
facet_grid(. ~province) +
ylim(0,35) +
geom_text(aes(label = sprintf("%.2f",mother_mean_age)), fontface = "bold", vjust = 1.5, colour = "white", size = 3) +
labs(x = "\n Years", y = "Mean Mother Age\n", title = "\n Mean Mother Age by Year and Metropolis \n") +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(face="bold", colour="darkgreen", size = 12),
axis.title.y = element_text(face="bold", colour="darkgreen", size = 12),
legend.title = element_text(face="bold", size = 10),
strip.background = element_rect(fill="lightblue", colour="black", size=1),
strip.text = element_text(face="bold", size=rel(1.2))) +
labs(title = "Mean Age of Mother by Metropolis in the last 3 years")
mean_age_of_mother_by_statistic %>%
ggplot(aes(x = mother_mean_age, fill = year)) +
geom_histogram(bins = 10) +
facet_grid(year~.) +
labs(title = "Mean Age of Mother by Year")
mean_age_of_mother_by_statistic %>%
select(region,year ,mother_mean_age) %>%
group_by(region,year) %>%
summarise(min_mean_mother_age = min(mother_mean_age)) %>%
pivot_wider(values_from = min_mean_mother_age, names_from = year)
plot_data1<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(desc(avg_rate)) %>%
top_n( 5)
ggplot(plot_data1,aes(x=province, y=avg_rate, fill= province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the average divorce rate (2012-2021)")
plot_data2<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(avg_rate) %>%
slice(1:5)
ggplot(plot_data2,aes(x=province, y=avg_rate, fill=province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the lowest average divorce rate (2012-2021)")
pti <- c("readxl","dplyr","tidyverse", "ggplot2", "lubridate", "tidyr", "stringi", "hrbrthemes", "viridis", "scales", "knitr")
pti <- pti[!(pti %in% installed.packages())]
if(length(pti)>0){
install.packages(pti)
}
library(readxl)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(tidyr)
library(stringi)
library(hrbrthemes)
library(viridis)
library(scales)
library(knitr)
labour_force_status_by_reg <- readRDS("docs/tuik/Labour_force_status_by_reg.rds")
employed_rate_by_marital_status <- readRDS("docs/tuik/Employed_rate_by_marital_status.rds")
reasons_of_not_being_in_lab_for <- readRDS("docs/tuik/Reasons_of_not_being_in_lab_for.rds")
crude_divorce_rate_by_provinces <- readRDS("docs/tuik/Crude_divorce_rate_by_provinces.rds")
df1 <- labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, unemployment_rate, employment_rate)
df2 <- employed_rate_by_marital_status %>%
filter(marital_status == "Divorced") %>%
select(year, gender, divorced_emp_rate = employed_rate)
df3 <- df1 %>%
inner_join(df2, by = c("year", "gender"))
df3 %>%
ggplot() +
geom_line(aes(x = year, y = labour_force_participation_rate, colour = "red")) +
geom_line(aes(x = year, y = employment_rate, colour = "blue")) +
scale_color_identity(name = '',
breaks = c('red', 'blue'),
labels = c("LF Participation Rate", "Employment Rate"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df3$year):max(df3$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
facet_wrap( ~ gender) +
ylab("")
df4 <- df3 %>%
select(year, gender, labour_force_participation_rate) %>%
pivot_wider(names_from = gender, values_from =  labour_force_participation_rate) %>%
mutate(lfp_ratio = Male / Female) %>%
select(year, lfp_ratio)
df5 <- df3 %>%
select(year, gender, employment_rate) %>%
pivot_wider(names_from = gender, values_from =  employment_rate) %>%
mutate(emp_ratio = Male / Female) %>%
select(year, emp_ratio)
df4 %>%
inner_join(df5, by = "year") %>%
ggplot() +
geom_line(aes(x = year, y = lfp_ratio, colour = "green")) +
geom_line(aes(x = year, y = emp_ratio, colour = "blue")) +
scale_color_identity(name = '',
breaks = c('green', 'blue'),
labels = c("LF Participation Ratio", "Employment Ratio"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df5$year):max(df5$year))) +
ylab("")
df3 %>%
ggplot() +
geom_line(aes(x = year, y = employment_rate, colour = "blue")) +
geom_line(aes(x = year, y = divorced_emp_rate, colour = "deeppink1"))  +
scale_color_identity(name = '',
breaks = c('blue', 'deeppink1'),
labels = c("Employment Rate", "Divorced Employment Rate"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df3$year):max(df3$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
facet_wrap( ~ gender) +
ylab("")
diff<-female%>%mutate(ratio=male$employed_rate/female$employed_rate) %>%select(-gender)
ggplot(diff, aes(x = year, y = ratio, color = marital_status)) + geom_line() +
scale_x_continuous(breaks = c(min(female$year):max(female$year))) +
labs(title = "Employment Ratio")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot() +
geom_line(aes(x = year, y = unemployment_rate, color = gender)) +
facet_wrap( ~ region) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Unemployment Rate by Region") +
ylab("unemployment rate")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot(aes(y=unemployment_rate, group = gender)) +
geom_boxplot(fill="steelblue") +
facet_grid(gender ~ region) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
theme(strip.text.x = element_text(size = 3)) +
labs(title = "Unemployment Distribution by Region") +
ylab("unemployment rate")
df6 <- reasons_of_not_being_in_lab_for %>%
group_by(gender, reason) %>%
summarise(pop_not_in_lab_force = sum(pop_not_in_lab_force), .groups = "drop")
df7 <- df6 %>%
filter(reason == "Total") %>%
select(gender, total_pop_not_in_lab_force = pop_not_in_lab_force)
df8 <- df6 %>%
filter(reason != "Total")
df9 <- df7 %>%
inner_join(df8, by = "gender") %>%
mutate(pop_not_in_lab_force_rate = pop_not_in_lab_force / total_pop_not_in_lab_force) %>%
select(gender, reason, pop_not_in_lab_force_rate)
df9 %>%
ggplot(aes(x = "", y = pop_not_in_lab_force_rate, fill = reason )) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
geom_text(aes(label = scales::percent(round(pop_not_in_lab_force_rate,2))),
position = position_stack(vjust = 0.5), size = 2, angle = -80) +
facet_wrap( ~ gender) +
xlab("") +
ylab("") +
theme_void() +
theme(legend.text=element_text(size=4), legend.position = "bottom", legend.title=element_blank())
plot_data1<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(desc(avg_rate)) %>%
top_n(5)
ggplot(plot_data1,aes(x=reorder(province, -avg_rate), y=avg_rate, fill= province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the average divorce rate") +
xlab("province") +
ylab("average divorce rate")
plot_data2<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(avg_rate) %>%
slice(1:5)
ggplot(plot_data2,aes(x=reorder(province, -avg_rate), y=avg_rate, fill=province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the lowest average divorce rate") +
xlab("province") +
ylab("average divorce rate")
df1 <- labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, unemployment_rate, employment_rate)
df2 <- employed_rate_by_marital_status %>%
filter(marital_status == "Divorced") %>%
select(year, gender, divorced_emp_rate = employed_rate)
df3 <- df1 %>%
inner_join(df2, by = c("year", "gender"))
df3 %>%
ggplot() +
geom_line(aes(x = year, y = labour_force_participation_rate, colour = "red")) +
geom_line(aes(x = year, y = employment_rate, colour = "blue")) +
scale_color_identity(name = '',
breaks = c('red', 'blue'),
labels = c("LF Participation Rate", "Employment Rate"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df3$year):max(df3$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
facet_wrap( ~ gender) +
ylab("")
df1 <- labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, unemployment_rate, employment_rate)
df2 <- employed_rate_by_marital_status %>%
filter(marital_status == "Divorced") %>%
select(year, gender, divorced_emp_rate = employed_rate)
df3 <- df1 %>%
inner_join(df2, by = c("year", "gender"))
df1 <- labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, unemployment_rate, employment_rate)
df2 <- employed_rate_by_marital_status %>%
filter(marital_status == "Divorced") %>%
select(year, gender, divorced_emp_rate = employed_rate)
df3 <- df1 %>%
inner_join(df2, by = c("year", "gender"))
df6 <- reasons_of_not_being_in_lab_for %>%
group_by(gender, reason) %>%
summarise(pop_not_in_lab_force = sum(pop_not_in_lab_force), .groups = "drop")
df7 <- df6 %>%
filter(reason == "Total") %>%
select(gender, total_pop_not_in_lab_force = pop_not_in_lab_force)
df8 <- df6 %>%
filter(reason != "Total")
df9 <- df7 %>%
inner_join(df8, by = "gender") %>%
mutate(pop_not_in_lab_force_rate = pop_not_in_lab_force / total_pop_not_in_lab_force) %>%
select(gender, reason, pop_not_in_lab_force_rate)
df9 %>%
ggplot(aes(x = "", y = pop_not_in_lab_force_rate, fill = reason )) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
geom_text(aes(label = scales::percent(round(pop_not_in_lab_force_rate,2))),
position = position_stack(vjust = 0.5), size = 2, angle = -80) +
facet_wrap( ~ gender) +
xlab("") +
ylab("") +
theme_void() +
theme(legend.text=element_text(size=4), legend.position = "bottom", legend.title=element_blank())
plot_data1<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(desc(avg_rate)) %>%
top_n(5)
ggplot(plot_data1,aes(x=reorder(province, -avg_rate), y=avg_rate, fill= province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the average divorce rate") +
xlab("province") +
ylab("average divorce rate")
plot_data2<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(avg_rate) %>%
slice(1:5)
ggplot(plot_data2,aes(x=reorder(province, -avg_rate), y=avg_rate, fill=province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the lowest average divorce rate") +
xlab("province") +
ylab("average divorce rate")
female<-employed_rate_by_marital_status%>%filter(gender=="Female")
male<-employed_rate_by_marital_status%>%filter(gender=="Male")
diff<-female%>%mutate(ratio=male$employed_rate/female$employed_rate) %>%select(-gender)
ggplot(diff, aes(x = year, y = ratio, color = marital_status)) + geom_line() +
scale_x_continuous(breaks = c(min(female$year):max(female$year))) +
labs(title = "Employment Ratio")
pti <- c("readxl","dplyr","tidyverse", "ggplot2", "lubridate", "tidyr", "stringi", "hrbrthemes", "viridis", "scales", "knitr")
pti <- pti[!(pti %in% installed.packages())]
if(length(pti)>0){
install.packages(pti)
}
library(readxl)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(tidyr)
library(stringi)
library(hrbrthemes)
library(viridis)
library(scales)
library(knitr)
labour_force_status_by_reg <- readRDS("docs/tuik/Labour_force_status_by_reg.rds")
employed_rate_by_marital_status <- readRDS("docs/tuik/Employed_rate_by_marital_status.rds")
reasons_of_not_being_in_lab_for <- readRDS("docs/tuik/Reasons_of_not_being_in_lab_for.rds")
crude_divorce_rate_by_provinces <- readRDS("docs/tuik/Crude_divorce_rate_by_provinces.rds")
df1 <- labour_force_status_by_reg %>%
filter(region == "Total") %>%
select(year, gender, labour_force_participation_rate, unemployment_rate, employment_rate)
df2 <- employed_rate_by_marital_status %>%
filter(marital_status == "Divorced") %>%
select(year, gender, divorced_emp_rate = employed_rate)
df3 <- df1 %>%
inner_join(df2, by = c("year", "gender"))
df3 %>%
ggplot() +
geom_line(aes(x = year, y = labour_force_participation_rate, colour = "red")) +
geom_line(aes(x = year, y = employment_rate, colour = "blue")) +
scale_color_identity(name = '',
breaks = c('red', 'blue'),
labels = c("LF Participation Rate", "Employment Rate"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df3$year):max(df3$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
facet_wrap( ~ gender) +
ylab("")
df4 <- df3 %>%
select(year, gender, labour_force_participation_rate) %>%
pivot_wider(names_from = gender, values_from =  labour_force_participation_rate) %>%
mutate(lfp_ratio = Male / Female) %>%
select(year, lfp_ratio)
df5 <- df3 %>%
select(year, gender, employment_rate) %>%
pivot_wider(names_from = gender, values_from =  employment_rate) %>%
mutate(emp_ratio = Male / Female) %>%
select(year, emp_ratio)
df4 %>%
inner_join(df5, by = "year") %>%
ggplot() +
geom_line(aes(x = year, y = lfp_ratio, colour = "green")) +
geom_line(aes(x = year, y = emp_ratio, colour = "blue")) +
scale_color_identity(name = '',
breaks = c('green', 'blue'),
labels = c("LF Participation Ratio", "Employment Ratio"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df5$year):max(df5$year))) +
ylab("")
df3 %>%
ggplot() +
geom_line(aes(x = year, y = employment_rate, colour = "blue")) +
geom_line(aes(x = year, y = divorced_emp_rate, colour = "deeppink1"))  +
scale_color_identity(name = '',
breaks = c('blue', 'deeppink1'),
labels = c("Employment Rate", "Divorced Employment Rate"),
guide = 'legend') +
theme(legend.position = "top") +
scale_x_continuous(breaks = c(min(df3$year):max(df3$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
facet_wrap( ~ gender) +
ylab("")
female<-employed_rate_by_marital_status%>%filter(gender=="Female")
male<-employed_rate_by_marital_status%>%filter(gender=="Male")
diff<-female%>%mutate(ratio=male$employed_rate/female$employed_rate) %>%select(-gender)
ggplot(diff, aes(x = year, y = ratio, color = marital_status)) + geom_line() +
scale_x_continuous(breaks = c(min(female$year):max(female$year))) +
labs(title = "Employment Ratio")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot() +
geom_line(aes(x = year, y = unemployment_rate, color = gender)) +
facet_wrap( ~ region) +
scale_x_continuous(breaks = c(min(labour_force_status_by_reg$year):max(labour_force_status_by_reg$year))) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
labs(title = "Unemployment Rate by Region") +
ylab("unemployment rate")
labour_force_status_by_reg %>%
filter(region != "Total") %>%
ggplot(aes(y=unemployment_rate, group = gender)) +
geom_boxplot(fill="steelblue") +
facet_grid(gender ~ region) +
theme(axis.text.x = element_text(angle=90,vjust=1,hjust=1)) +
theme(strip.text.x = element_text(size = 3)) +
labs(title = "Unemployment Distribution by Region") +
ylab("unemployment rate")
df6 <- reasons_of_not_being_in_lab_for %>%
group_by(gender, reason) %>%
summarise(pop_not_in_lab_force = sum(pop_not_in_lab_force), .groups = "drop")
df7 <- df6 %>%
filter(reason == "Total") %>%
select(gender, total_pop_not_in_lab_force = pop_not_in_lab_force)
df8 <- df6 %>%
filter(reason != "Total")
df9 <- df7 %>%
inner_join(df8, by = "gender") %>%
mutate(pop_not_in_lab_force_rate = pop_not_in_lab_force / total_pop_not_in_lab_force) %>%
select(gender, reason, pop_not_in_lab_force_rate)
df9 %>%
ggplot(aes(x = "", y = pop_not_in_lab_force_rate, fill = reason )) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0) +
geom_text(aes(label = scales::percent(round(pop_not_in_lab_force_rate,2))),
position = position_stack(vjust = 0.5), size = 2, angle = -80) +
facet_wrap( ~ gender) +
xlab("") +
ylab("") +
theme_void() +
theme(legend.text=element_text(size=4), legend.position = "bottom", legend.title=element_blank())
plot_data1<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(desc(avg_rate)) %>%
top_n(5)
ggplot(plot_data1,aes(x=reorder(province, -avg_rate), y=avg_rate, fill= province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the average divorce rate") +
xlab("province") +
ylab("average divorce rate")
plot_data2<-crude_divorce_rate_by_provinces %>%
group_by(province) %>%
summarise(avg_rate = mean(crude_divorce_rate))%>%
arrange(avg_rate) %>%
slice(1:5)
ggplot(plot_data2,aes(x=reorder(province, -avg_rate), y=avg_rate, fill=province)) +
geom_bar(stat = "identity") +
labs(title = "Top 5 provinces for the lowest average divorce rate") +
xlab("province") +
ylab("average divorce rate")
